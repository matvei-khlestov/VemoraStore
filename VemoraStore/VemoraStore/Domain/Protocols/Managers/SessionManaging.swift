//
//  SessionManaging.swift
//  VemoraStore
//
//  Created by Matvei Khlestov on 13.10.2025.
//

import Foundation

/// Протокол `SessionManaging`
///
/// Определяет интерфейс менеджера пользовательской сессии,
/// отвечающего за контроль авторизации, актуальность состояния корзины
/// и поддержку корректного жизненного цикла пользовательских данных.
///
/// Основные задачи:
/// - отслеживание состояния авторизации пользователя (`start`);
/// - ручная или фоновая проверка актуальности сессии (`refreshNow`);
/// - предоставление снимка корзины для оформления заказа (`cartItemsSnapshot`).
///
/// Используется в:
/// - `AppCoordinator` — для определения сценариев входа/выхода;
/// - `CheckoutCoordinator` — для передачи текущих товаров при оформлении заказа;
/// - `CartRepository` — как источник данных о локальной корзине перед оформлением.
///
/// Менеджер реализует централизованный контроль пользовательского состояния,
/// обеспечивая единообразную работу авторизации и синхронизации корзины.

protocol SessionManaging {
    
    // MARK: - Lifecycle
    
    /// Запускает наблюдение за состоянием авторизации пользователя.
    func start()
    
    /// Выполняет немедленную проверку актуальности сессии и статуса авторизации.
    func refreshNow()
    
    // MARK: - Snapshot
    
    /// Снимок текущего состояния корзины — используется при переходе
    /// на экран оформления заказа, чтобы избежать пересчёта данных в реальном времени.
    var cartItemsSnapshot: [CartItem] { get }
}
